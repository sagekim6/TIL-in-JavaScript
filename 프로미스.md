# 프로미스(Promise)

- 자바스크립트 안에 내장되어 있는 객체이다.
- 비동기적인 작업을 수행할 때 콜백 함수를 대신해서 유용하게 쓰인다.
- 프로미스는 비동기 처리가 어떻게 진행되고 있는지를 나타내는 상태 정보를 갖는다

  1.pending(비동기 처리가 아직 수행되지 않는 상태)  
  2.fulfilled(수행 성공) : resolve 함수를 호출한다.  
  3.rejected(수행 실패) : reject 함수를 호출한다.   
     -> fulfilled, rejected 상태를 settled 상태라고 한다.  
     pending 상태에선 다른 상태로 변화할 수 있지만 settled 상태가 되면 다른 상태로 변화할 수 없다.

### 프로미스 생성

- 프로미스는 클래스라 객체를 먼저 생성한다.
- 인자로 콜백 함수를 전달한다. 그 안에서 또 resolve, reject 함수를 전달한다.

```javascript
// new 연산자로 프로미스 객체 생성
const promise = new Promise((resolve, reject) => {
  console.log("doing something...");
  setTimeout(() => {
    resolve("sage"); // 수행 성공 시->resolve 콜백 함수 실행
    reject(new Error("no network")); // 수행 실패 시-> reject 콜백 함수 실행
  }, 2000);
});
```

### 프로미스 후속 처리 메소드(then, catch, finally)

- 프로미스의 처리 상태가 변화하면 이에 따른 후속 처리를 해야한다.  
  -> 후속 처리 메소드에 인수로 전달한 콜백 함수가 선택적으로 호출된다
- then, catch, finally 메소드는 값을 바로 전달 하거나 프로미스를 반환한다.

#### then 메소드

- 두 개의 콜백 함수를 인수로 전달받는다.
- 첫 번째는 성공 처리 콜백 함수이고 두 번째는 실패 처리 콜백 함수이다.

#### catch 메소드

- 하나의 콜백 함수를 인수로 전달 받는다.
- 수행 실패 상태인 경우에 호출 된다.

#### finally 메소드

- 성공이나 실패에 상관 없이 무조건 한 번 호출된다.  
  ->프로미스의 상태와 상관없이 공통적으로 수행해야 할 처리 내용이 있을 때 유용하다.

```javascript
const promise = new Promise((resolve, reject) => {
  console.log("doing something...");
  setTimeout(() => {
    resolve("sage");
    reject(new Error("no network"));
  }, 2000);
}); // 'doing something...' 출력

promise
  .then((value) => {
    console.log(value); // resolve()의 인자로 넣어준 값이 value로 할당된다.
  })
  .catch((error) => {
    // reject인 상태가 되면 출력된다.
    console.log(error);
  })
  .finally(() => {
    console.log("finally");
  });
// 'sage'
// 'finally' 출력
```
